<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci√≥n de Madurez Digital - Versi√≥n Ejecutiva</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #1a202c;
        }

        .app-container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.35);
            overflow: hidden;
            animation: slideUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 200%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
            animation: shimmer 4s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 12px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.25);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 15px;
            font-weight: 600;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .progress-section {
            background: linear-gradient(to bottom, #f8fafc, #ffffff);
            padding: 24px 40px;
            border-bottom: 1px solid #e2e8f0;
        }

        .progress-bar-container {
            background: #e2e8f0;
            height: 14px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 20px;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            text-align: center;
            margin-top: 12px;
            font-weight: 700;
            color: #3b82f6;
            font-size: 1rem;
        }

        .content {
            padding: 40px;
        }

        .welcome-content {
            max-width: 700px;
            margin: 0 auto;
        }

        .welcome-content h2 {
            color: #1e3a8a;
            font-size: 2rem;
            font-weight: 800;
            text-align: center;
            margin-bottom: 20px;
        }

        .welcome-intro {
            font-size: 1.1rem;
            color: #475569;
            line-height: 1.8;
            text-align: center;
            margin-bottom: 30px;
        }

        .highlight-box {
            background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
            border-left: 5px solid #3b82f6;
            padding: 24px;
            border-radius: 12px;
            margin: 25px 0;
        }

        .highlight-box h3 {
            color: #1e3a8a;
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .highlight-box ul {
            list-style: none;
            padding: 0;
        }

        .highlight-box li {
            padding: 8px 0 8px 28px;
            position: relative;
            line-height: 1.6;
            color: #334155;
        }

        .highlight-box li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #3b82f6;
            font-weight: 900;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 700;
            color: #1e293b;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s;
            font-family: inherit;
            background: #f8fafc;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            background: white;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .dimension-header {
            background: linear-gradient(135deg, #f1f5f9 0%, #e0e7ff 100%);
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            border-left: 6px solid #3b82f6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .dimension-header h2 {
            color: #1e3a8a;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dimension-header p {
            color: #475569;
            line-height: 1.7;
            font-size: 1.05rem;
        }

        .question-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 28px;
            margin-bottom: 20px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .question-card:hover {
            border-color: #3b82f6;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.15);
            transform: translateY(-2px);
        }

        .question-card.answered {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #ffffff 100%);
        }

        .question-header {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
        }

        .question-number {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            min-width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
            flex-shrink: 0;
        }

        .question-text {
            flex: 1;
            font-size: 1.1rem;
            line-height: 1.6;
            color: #1e293b;
            font-weight: 600;
        }

        .rating-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
        }

        .rating-option input[type="radio"] {
            display: none;
        }

        .rating-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 10px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
            text-align: center;
        }

        .rating-label:hover {
            border-color: #3b82f6;
            background: #eff6ff;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .rating-option input:checked + .rating-label {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border-color: #3b82f6;
            font-weight: 700;
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .rating-value {
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 4px;
        }

        .rating-desc {
            font-size: 0.75rem;
            opacity: 0.9;
            font-weight: 600;
        }

        .btn {
            padding: 16px 36px;
            border: none;
            border-radius: 12px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        .btn:active:not(:disabled) {
            transform: scale(0.98);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
        }

        .btn-secondary {
            background: #64748b;
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
            gap: 16px;
        }

        .score-hero {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(30, 58, 138, 0.4);
        }

        .score-hero::before {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 70%);
            top: -200px;
            right: -200px;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-20px, 20px); }
        }

        .score-value {
            font-size: 6rem;
            font-weight: 900;
            margin: 20px 0;
            position: relative;
            z-index: 1;
            text-shadow: 0 4px 20px rgba(0,0,0,0.2);
            line-height: 1;
        }

        .score-label {
            font-size: 1.4rem;
            opacity: 0.95;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .level-badge {
            display: inline-block;
            padding: 14px 32px;
            background: rgba(255,255,255,0.25);
            border-radius: 30px;
            font-size: 1.5rem;
            font-weight: 800;
            margin-top: 20px;
            position: relative;
            z-index: 1;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.4);
        }

        .dimensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin: 40px 0;
        }

        .dimension-result-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 28px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .dimension-result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 28px rgba(0,0,0,0.12);
            border-color: #3b82f6;
        }

        .dimension-result-card h3 {
            color: #1e3a8a;
            font-size: 1.15rem;
            font-weight: 800;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dimension-score {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 12px 0;
        }

        .dimension-bar {
            background: #e2e8f0;
            height: 14px;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 16px;
        }

        .dimension-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 10px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .roadmap-section {
            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border-left: 6px solid #10b981;
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.1);
        }

        .roadmap-section h3 {
            color: #065f46;
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .roadmap-steps {
            display: grid;
            gap: 24px;
        }

        .roadmap-step {
            background: white;
            padding: 28px;
            border-radius: 16px;
            border-left: 5px solid #10b981;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            transition: all 0.3s;
        }

        .roadmap-step:hover {
            transform: translateX(8px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .roadmap-step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-radius: 50%;
            font-weight: 900;
            font-size: 1.2rem;
            margin-bottom: 12px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .roadmap-step h4 {
            color: #065f46;
            font-size: 1.3rem;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .roadmap-step p {
            color: #475569;
            line-height: 1.7;
            margin-bottom: 12px;
        }

        .roadmap-step ul {
            list-style: none;
            padding: 0;
        }

        .roadmap-step li {
            padding: 6px 0 6px 24px;
            position: relative;
            color: #334155;
            line-height: 1.6;
        }

        .roadmap-step li::before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #10b981;
            font-weight: 900;
        }

        .action-buttons {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .chart-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border: 2px solid #e2e8f0;
            box-shadow: 0 4px 16px rgba(0,0,0,0.06);
        }

        .chart-container h3 {
            text-align: center;
            color: #1e3a8a;
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .content {
                padding: 24px;
            }

            .rating-options {
                grid-template-columns: repeat(3, 1fr);
            }

            .dimensions-grid {
                grid-template-columns: 1fr;
            }

            .score-value {
                font-size: 4rem;
            }

            .navigation {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        .scale-reference {
            background: #eff6ff;
            border: 2px solid #3b82f6;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .scale-reference h4 {
            color: #1e3a8a;
            font-size: 1.1rem;
            font-weight: 800;
            margin-bottom: 16px;
        }

        .scale-items {
            display: grid;
            gap: 8px;
        }

        .scale-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.9rem;
            color: #334155;
        }

        .scale-item-number {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Cuestionario optimizado - 45 preguntas cr√≠ticas en 6 dimensiones
        const questionsData = {
            "D1": {
                title: "Estrategia y Liderazgo Digital",
                description: "Visi√≥n estrat√©gica, compromiso del liderazgo y gobierno de la transformaci√≥n digital",
                icon: "üéØ",
                questions: [
                    "¬øExiste un plan estrat√©gico digital documentado, actualizado y alineado con la estrategia corporativa?",
                    "¬øLa alta direcci√≥n demuestra compromiso visible y asigna recursos (presupuesto 3-5% ingresos) a digitalizaci√≥n?",
                    "¬øExisten roles digitales formales con autoridad (CDO, CTO, VP Digital)?",
                    "¬øSe monitorean tendencias PropTech/ConTech y se realiza benchmark digital vs. competencia?",
                    "¬øExiste un roadmap de transformaci√≥n digital a 3-5 a√±os con objetivos medibles (KPIs)?",
                    "¬øPredomina una cultura de innovaci√≥n, experimentaci√≥n y tolerancia al error?",
                    "¬øSe comunican regularmente avances digitales y hay incentivos a la innovaci√≥n?"
                ]
            },
            "D2": {
                title: "Experiencia del Cliente Digital",
                description: "Capacidad de ofrecer experiencias digitales excepcionales en todo el journey del cliente",
                icon: "üè†",
                questions: [
                    "¬øEl sitio web es moderno, responsive, actualizado y ofrece informaci√≥n completa de proyectos?",
                    "¬øSe ofrecen experiencias inmersivas (tours virtuales 360¬∞, VR/AR, configuradores digitales)?",
                    "¬øExiste un CRM robusto para gesti√≥n de leads con seguimiento omnicanal (web, WhatsApp, email)?",
                    "¬øEl proceso de compra/reserva/separaci√≥n es mayormente digital con firma electr√≥nica?",
                    "¬øExiste app m√≥vil o portal digital para seguimiento de obra y postventa?",
                    "¬øLas comunicaciones son personalizadas basadas en datos del cliente?",
                    "¬øSe mide sistem√°ticamente satisfacci√≥n digital (NPS, CSAT) y se act√∫a sobre insights?"
                ]
            },
            "D3": {
                title: "Procesos y Tecnolog√≠a",
                description: "Digitalizaci√≥n de operaciones, herramientas implementadas e integraci√≥n tecnol√≥gica",
                icon: "‚öôÔ∏è",
                questions: [
                    "¬øSe usa BIM (Building Information Modeling) activamente en proyectos e integrado con gesti√≥n?",
                    "¬øExiste software especializado de gesti√≥n de construcci√≥n con control de obra en tiempo real?",
                    "¬øLa gesti√≥n de subcontratistas, proveedores, calidad y cambios es digital (no Excel/papel)?",
                    "¬øEl marketing est√° automatizado (email marketing, ads, retargeting, social media)?",
                    "¬øExiste un ERP implementado y utilizado activamente por >70% del equipo?",
                    "¬øLa facturaci√≥n es 100% electr√≥nica y tesorer√≠a/flujo de caja se gestionan digitalmente?",
                    "¬øLos sistemas clave est√°n integrados (APIs/integraciones nativas) con 'single source of truth'?",
                    "¬øSe usa cloud computing, hay protocolos de ciberseguridad robustos y backup autom√°tico?"
                ]
            },
            "D4": {
                title: "Datos e Inteligencia de Negocio",
                description: "Capacidad de capturar, analizar y usar datos para decisiones estrat√©gicas informadas",
                icon: "üìä",
                questions: [
                    "¬øExisten dashboards ejecutivos en tiempo real con KPIs clave del negocio?",
                    "¬øLa calidad de datos es alta, consistente y confiable para toma de decisiones?",
                    "¬øLas decisiones estrat√©gicas se basan en datos y anal√≠tica (no solo intuici√≥n)?",
                    "¬øSe usa anal√≠tica avanzada o predictiva (precios, demanda, riesgos, rentabilidad)?",
                    "¬øHay segmentaci√≥n inteligente de clientes y an√°lisis de tendencias de mercado?",
                    "¬øSe analiza rentabilidad detallada por proyecto con control de costos en tiempo real?"
                ]
            },
            "D5": {
                title: "Talento y Cultura Digital",
                description: "Disponibilidad de competencias digitales, programas de formaci√≥n y cultura de aprendizaje",
                icon: "üë•",
                questions: [
                    "¬øSe han evaluado brechas de competencias digitales con plan de capacitaci√≥n estructurado?",
                    "¬øHay presupuesto anual dedicado a formaci√≥n digital (>1% de payroll)?",
                    "¬øSe ejecutan programas activos de upskilling/reskilling en herramientas digitales clave?",
                    "¬øSe logra atraer, contratar y retener talento digital especializado?",
                    "¬øExiste knowledge management efectivo con cultura de aprendizaje continuo?",
                    "¬øEl equipo tiene certificaciones en herramientas clave (BIM, PMP, Agile, Data Analytics)?"
                ]
            },
            "D6": {
                title: "Innovaci√≥n y Modelo de Negocio",
                description: "Capacidad de innovar, experimentar con nuevas tecnolog√≠as y evolucionar el modelo de negocio",
                icon: "üöÄ",
                questions: [
                    "¬øExiste presupuesto dedicado a innovaci√≥n (0.5-2% de ingresos) gestionado activamente?",
                    "¬øSe usan metodolog√≠as √°giles (Scrum, Kanban, Design Thinking) en proyectos?",
                    "¬øSe ejecutan regularmente proyectos piloto con nuevas tecnolog√≠as (IA, IoT, blockchain)?",
                    "¬øHay alianzas activas con PropTech/ConTech, startups o universidades?",
                    "¬øSe exploran activamente nuevos modelos de negocio digitales?",
                    "¬øSe implementan tecnolog√≠as emergentes en proyectos (drones, impresi√≥n 3D, Smart Buildings)?",
                    "¬øLa velocidad de implementaci√≥n de innovaciones es alta con cultura de prototipado r√°pido (MVPs)?"
                ]
            }
        };

        const ratingScale = [
            { value: 0, label: "0", desc: "No existe" },
            { value: 1, label: "1", desc: "Conocido" },
            { value: 2, label: "2", desc: "Piloto" },
            { value: 3, label: "3", desc: "Parcial" },
            { value: 4, label: "4", desc: "Avanzado" },
            { value: 5, label: "5", desc: "√ìptimo" }
        ];

        const App = () => {
            const [screen, setScreen] = useState('welcome');
            const [currentDim, setCurrentDim] = useState('D1');
            const [answers, setAnswers] = useState({});
            const [companyInfo, setCompanyInfo] = useState({
                name: '',
                date: new Date().toISOString().split('T')[0],
                evaluator: ''
            });
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                const saved = localStorage.getItem('maturityData');
                if (saved) {
                    const data = JSON.parse(saved);
                    setAnswers(data.answers || {});
                    setCompanyInfo(data.companyInfo || companyInfo);
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('maturityData', JSON.stringify({ answers, companyInfo }));
            }, [answers, companyInfo]);

            const handleAnswer = (dim, idx, val) => {
                setAnswers(prev => ({
                    ...prev,
                    [dim]: { ...(prev[dim] || {}), [idx]: val }
                }));
            };

            const getProgress = () => {
                const total = Object.keys(questionsData).reduce((sum, dim) => 
                    sum + questionsData[dim].questions.length, 0);
                const answered = Object.keys(questionsData).reduce((sum, dim) => 
                    sum + Object.keys(answers[dim] || {}).length, 0);
                return (answered / total) * 100;
            };

            const calculateResults = () => {
                const results = {};
                let totalScore = 0;
                let maxScore = 0;

                Object.keys(questionsData).forEach(dim => {
                    const dimAnswers = answers[dim] || {};
                    const score = Object.values(dimAnswers).reduce((sum, val) => sum + val, 0);
                    const max = questionsData[dim].questions.length * 5;
                    
                    results[dim] = {
                        score,
                        maxScore: max,
                        percentage: max > 0 ? (score / max) * 100 : 0
                    };
                    
                    totalScore += score;
                    maxScore += max;
                });

                const normalizedScore = maxScore > 0 ? (totalScore / maxScore) * 100 : 0;
                const level = getLevel(normalizedScore);

                return { dimensions: results, totalScore, maxScore, normalizedScore, level };
            };

            const getLevel = (score) => {
                if (score < 20) return { 
                    level: 0, 
                    name: "Nivel 0: Inicial", 
                    color: "#dc2626",
                    desc: "Sin estrategia digital, procesos manuales"
                };
                if (score < 40) return { 
                    level: 1, 
                    name: "Nivel 1: Emergente", 
                    color: "#ea580c",
                    desc: "Conciencia digital, iniciativas aisladas"
                };
                if (score < 60) return { 
                    level: 2, 
                    name: "Nivel 2: Definido", 
                    color: "#eab308",
                    desc: "Estrategia clara, herramientas implementadas"
                };
                if (score < 75) return { 
                    level: 3, 
                    name: "Nivel 3: Gestionado", 
                    color: "#3b82f6",
                    desc: "Procesos optimizados, cultura digital"
                };
                if (score < 90) return { 
                    level: 4, 
                    name: "Nivel 4: Optimizado", 
                    color: "#10b981",
                    desc: "Alta eficiencia, innovaci√≥n continua"
                };
                return { 
                    level: 5, 
                    name: "Nivel 5: Exponencial", 
                    color: "#8b5cf6",
                    desc: "Digital-first, modelos disruptivos"
                };
            };

            const getRoadmap = (level) => {
                const roadmaps = {
                    0: [
                        {
                            step: 1,
                            title: "Evaluaci√≥n del Estado Actual (Hecho ‚úì)",
                            desc: "Ya completaste este paso con esta evaluaci√≥n. Ahora conoces tu punto de partida.",
                            actions: ["Compartir resultados con equipo directivo", "Identificar 3 √°reas cr√≠ticas prioritarias"]
                        },
                        {
                            step: 2,
                            title: "Definici√≥n de la Estrategia Digital (Prioridad URGENTE)",
                            desc: "Establecer visi√≥n clara, prop√≥sito y asignar recursos.",
                            actions: [
                                "Designar un responsable de transformaci√≥n digital (CDO/VP Digital)",
                                "Definir presupuesto inicial: 1-3% de ingresos anuales",
                                "Crear comit√© de transformaci√≥n digital con sponsors ejecutivos",
                                "Documentar visi√≥n digital a 3 a√±os con 5-7 objetivos SMART"
                            ]
                        },
                        {
                            step: 3,
                            title: "Optimizaci√≥n Operativa (Primeros 90 d√≠as)",
                            desc: "Quick wins digitales que generen credibilidad.",
                            actions: [
                                "Digitalizar 2 procesos cr√≠ticos (ej: CRM b√°sico + firma electr√≥nica)",
                                "Implementar herramientas colaborativas (Microsoft 365 / Google Workspace)",
                                "Migrar a facturaci√≥n electr√≥nica 100%",
                                "Crear sitio web moderno y responsive"
                            ]
                        }
                    ],
                    1: [
                        {
                            step: 3,
                            title: "Optimizaci√≥n Operativa (Pr√≥ximos 6 meses)",
                            desc: "Digitalizar y automatizar procesos core.",
                            actions: [
                                "Implementar BIM en proyectos nuevos (capacitar equipo t√©cnico)",
                                "Integrar CRM + ERP con datos unificados",
                                "Automatizar marketing digital (email, ads, retargeting)",
                                "Digitalizar gesti√≥n de obra con tablets y apps especializadas"
                            ]
                        },
                        {
                            step: 4,
                            title: "Innovaci√≥n en Modelo de Negocio Actual",
                            desc: "Mejorar propuesta de valor con capacidades digitales.",
                            actions: [
                                "Lanzar tours virtuales 360¬∞ de proyectos",
                                "Crear configurador digital de acabados",
                                "Implementar app m√≥vil para seguimiento de obra",
                                "Ofrecer firma digital y proceso de compra 100% online"
                            ]
                        },
                        {
                            step: 5,
                            title: "Desarrollo de Capacidades (Continuo)",
                            desc: "Construir m√∫sculo digital en la organizaci√≥n.",
                            actions: [
                                "Programa de capacitaci√≥n: 40+ horas/a√±o por persona",
                                "Certificaciones en herramientas clave (BIM, CRM, Agile)",
                                "Contratar 2-3 perfiles digitales especializados",
                                "Crear cultura de experimentaci√≥n con 'viernes de innovaci√≥n'"
                            ]
                        }
                    ],
                    2: [
                        {
                            step: 4,
                            title: "Innovaci√≥n en Modelo de Negocio",
                            desc: "Explorar nuevas fuentes de ingresos digitales.",
                            actions: [
                                "Lanzar marketplace digital de acabados/proveedores",
                                "Ofrecer servicios de co-living o suscripciones digitales",
                                "Crear plataforma de gesti√≥n de comunidades residenciales",
                                "Implementar modelos de venta por etapas 100% digital"
                            ]
                        },
                        {
                            step: 5,
                            title: "Desarrollo de Capacidades Avanzadas",
                            desc: "Escalar capacidades con tecnolog√≠as exponenciales.",
                            actions: [
                                "Crear laboratorio de innovaci√≥n con presupuesto dedicado (0.5-1%)",
                                "Implementar IA para an√°lisis predictivo de demanda y precios",
                                "Usar IoT y Smart Buildings en proyectos premium",
                                "Establecer alianzas con 3-5 PropTech/ConTech"
                            ]
                        },
                        {
                            step: 6,
                            title: "Modelo de Negocio Disruptivo (Exploraci√≥n)",
                            desc: "Experimentar con modelos radicalmente diferentes.",
                            actions: [
                                "Pilotos de construcci√≥n modular / impresi√≥n 3D",
                                "Explorar tokenizaci√≥n de activos inmobiliarios (blockchain)",
                                "Crear vertical de PropTech como l√≠nea de negocio",
                                "Implementar gemelos digitales (digital twins) de edificios"
                            ]
                        }
                    ],
                    3: [
                        {
                            step: 6,
                            title: "Modelo de Negocio Disruptivo",
                            desc: "Escalar innovaciones disruptivas probadas.",
                            actions: [
                                "Lanzar plataforma PropTech como producto comercial",
                                "Implementar construcci√≥n modular a escala",
                                "Ofrecer servicios de Smart Buildings como servicio (SaaS)",
                                "Crear marketplaces B2B para industria"
                            ]
                        },
                        {
                            step: 7,
                            title: "Fusi√≥n Digital (Evoluci√≥n Continua)",
                            desc: "Integrar digital en el ADN organizacional.",
                            actions: [
                                "100% de procesos digitalizados y optimizados",
                                "Cultura digital-first con equipos √°giles auto-organizados",
                                "Ecosistema de partners digitales robusto",
                                "Dashboard predictivo con IA para decisiones estrat√©gicas",
                                "Organizaci√≥n exponencial: escalable, √°gil, data-driven"
                            ]
                        }
                    ]
                };

                if (level >= 4) {
                    return [
                        {
                            step: 7,
                            title: "Fusi√≥n Digital - Mantener Liderazgo",
                            desc: "Consolidar posici√≥n de l√≠der digital del sector.",
                            actions: [
                                "Evangelizar transformaci√≥n digital en el sector (conferencias, casos)",
                                "Crear aceleradora o fondo de inversi√≥n en PropTech",
                                "Exportar modelo de transformaci√≥n a otras geograf√≠as",
                                "Ser referente en adopci√≥n de tecnolog√≠as emergentes",
                                "Cultivar ecosistema de innovaci√≥n abierta"
                            ]
                        },
                        {
                            step: 0,
                            title: "Ciclo Continuo: Re-evaluar",
                            desc: "La transformaci√≥n nunca termina.",
                            actions: [
                                "Re-evaluar madurez cada 6 meses",
                                "Monitorear nuevas tecnolog√≠as exponenciales",
                                "Experimentar constantemente (10-20 pilotos/a√±o)",
                                "Medir velocidad de aprendizaje como KPI cr√≠tico"
                            ]
                        }
                    ];
                }

                return roadmaps[Math.min(level, 3)];
            };

            const createChart = (results) => {
                if (!chartRef.current) return;
                if (chartInstance.current) chartInstance.current.destroy();

                const ctx = chartRef.current.getContext('2d');
                const labels = Object.keys(questionsData).map(dim => 
                    questionsData[dim].icon + ' ' + questionsData[dim].title.split(' ')[0]
                );
                const data = Object.keys(questionsData).map(dim => 
                    results.dimensions[dim].percentage
                );

                chartInstance.current = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Madurez (%)',
                            data: data,
                            fill: true,
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            borderColor: 'rgb(59, 130, 246)',
                            pointBackgroundColor: 'rgb(59, 130, 246)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(59, 130, 246)',
                            pointRadius: 6,
                            pointHoverRadius: 8,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        scales: {
                            r: {
                                angleLines: { display: true, color: 'rgba(0,0,0,0.1)' },
                                suggestedMin: 0,
                                suggestedMax: 100,
                                ticks: { stepSize: 20, font: { size: 12, weight: 'bold' } },
                                pointLabels: { font: { size: 11, weight: 'bold' } }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(0,0,0,0.8)',
                                padding: 12,
                                titleFont: { size: 14, weight: 'bold' },
                                bodyFont: { size: 13 },
                                callbacks: {
                                    label: (ctx) => ctx.parsed.r.toFixed(1) + '%'
                                }
                            }
                        }
                    }
                });
            };

            const exportPDF = () => {
                alert('Funcionalidad de exportaci√≥n PDF disponible en versi√≥n completa. Por ahora, tome una captura de pantalla de los resultados.');
            };

            const reset = () => {
                if (confirm('¬øReiniciar evaluaci√≥n? Se perder√°n todos los datos.')) {
                    setAnswers({});
                    setCompanyInfo({ name: '', date: new Date().toISOString().split('T')[0], evaluator: '' });
                    setScreen('welcome');
                    setCurrentDim('D1');
                    localStorage.clear();
                }
            };

            // WELCOME SCREEN
            if (screen === 'welcome') {
                return (
                    <div className="app-container">
                        <div className="header">
                            <h1>üöÄ Evaluaci√≥n de Madurez Digital</h1>
                            <p className="subtitle">Sector Inmobiliario y Constructor - Versi√≥n Ejecutiva</p>
                            <div className="badge">‚ö° 45 Preguntas Estrat√©gicas | 20-30 minutos</div>
                        </div>
                        <div className="content welcome-content">
                            <h2>Bienvenido a su Diagn√≥stico Digital</h2>
                            <p className="welcome-intro">
                                Esta herramienta optimizada eval√∫a la madurez digital de su organizaci√≥n en 
                                <strong> 6 dimensiones cr√≠ticas</strong> con <strong>45 preguntas estrat√©gicas</strong>.
                                Al finalizar, recibir√° un roadmap personalizado basado en el 
                                <strong> Modelo Integral de Evoluci√≥n Digital Empresarial de 7 Pasos</strong>.
                            </p>

                            <div className="highlight-box">
                                <h3>üìã Informaci√≥n de su Empresa</h3>
                                <div className="form-group">
                                    <label className="form-label">Nombre de la Empresa</label>
                                    <input 
                                        type="text"
                                        className="form-input"
                                        value={companyInfo.name}
                                        onChange={(e) => setCompanyInfo({...companyInfo, name: e.target.value})}
                                        placeholder="Ej: Constructora ABC S.A."
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Fecha de Evaluaci√≥n</label>
                                    <input 
                                        type="date"
                                        className="form-input"
                                        value={companyInfo.date}
                                        onChange={(e) => setCompanyInfo({...companyInfo, date: e.target.value})}
                                    />
                                </div>
                                <div className="form-group">
                                    <label className="form-label">Evaluador(es)</label>
                                    <input 
                                        type="text"
                                        className="form-input"
                                        value={companyInfo.evaluator}
                                        onChange={(e) => setCompanyInfo({...companyInfo, evaluator: e.target.value})}
                                        placeholder="Ej: Juan P√©rez - Gerente General"
                                    />
                                </div>
                            </div>

                            <div className="highlight-box">
                                <h3>‚ú® Por qu√© esta evaluaci√≥n es diferente</h3>
                                <ul>
                                    <li><strong>R√°pida:</strong> 20-30 minutos vs. 60-90 min de evaluaciones extensas</li>
                                    <li><strong>Estrat√©gica:</strong> Solo preguntas cr√≠ticas que realmente importan</li>
                                    <li><strong>Accionable:</strong> Roadmap espec√≠fico basado en modelo probado de 7 pasos</li>
                                    <li><strong>Sectorial:</strong> 100% enfocada en inmobiliario y construcci√≥n</li>
                                    <li><strong>Pr√°ctica:</strong> Sin jerga t√©cnica innecesaria</li>
                                </ul>
                            </div>

                            <div className="highlight-box">
                                <h3>üéØ Las 6 Dimensiones que Evaluaremos</h3>
                                {Object.keys(questionsData).map(dim => (
                                    <div key={dim} style={{marginBottom: '12px', paddingBottom: '12px', borderBottom: '1px solid #ddd'}}>
                                        <strong style={{color: '#1e3a8a', fontSize: '1.05rem'}}>
                                            {questionsData[dim].icon} {questionsData[dim].title}
                                        </strong>
                                        <p style={{fontSize: '0.9rem', color: '#64748b', marginTop: '4px'}}>
                                            {questionsData[dim].description}
                                        </p>
                                    </div>
                                ))}
                            </div>

                            <div style={{textAlign: 'center', marginTop: '40px'}}>
                                <button 
                                    className="btn btn-primary"
                                    onClick={() => setScreen('evaluation')}
                                    style={{fontSize: '1.2rem', padding: '20px 48px'}}
                                >
                                    ‚ñ∂Ô∏è Comenzar Evaluaci√≥n
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // RESULTS SCREEN
            if (screen === 'results') {
                const results = calculateResults();
                
                useEffect(() => {
                    createChart(results);
                }, []);

                const roadmap = getRoadmap(results.level.level);

                return (
                    <div className="app-container">
                        <div className="header">
                            <h1>üìä Sus Resultados</h1>
                            <p className="subtitle">Diagn√≥stico Completo + Roadmap Personalizado</p>
                        </div>

                        <div className="content">
                            <div className="score-hero">
                                <div className="score-label">PUNTUACI√ìN GLOBAL DE MADUREZ DIGITAL</div>
                                <div className="score-value">{results.normalizedScore.toFixed(1)}</div>
                                <div style={{fontSize: '1.2rem', opacity: 0.95}}>de 100 puntos</div>
                                <div className="level-badge" style={{backgroundColor: results.level.color}}>
                                    {results.level.name}
                                </div>
                                <div style={{ marginTop: '20px', fontSize: '1.05rem', opacity: 0.9 }}>
                                    {results.level.desc}
                                </div>
                            </div>

                            <div className="chart-container">
                                <h3>üìà Radar de Madurez por Dimensi√≥n</h3>
                                <div style={{maxWidth: '600px', margin: '0 auto'}}>
                                    <canvas ref={chartRef}></canvas>
                                </div>
                            </div>

                            <h3 style={{textAlign: 'center', color: '#1e3a8a', fontSize: '2rem', fontWeight: '900', margin: '40px 0 24px'}}>
                                üìä Detalle por Dimensi√≥n
                            </h3>

                            <div className="dimensions-grid">
                                {Object.keys(questionsData).map(dim => {
                                    const pct = results.dimensions[dim].percentage;
                                    let status = '‚ö† Cr√≠tico';
                                    let color = '#dc2626';
                                    if (pct >= 75) { status = '‚úì Excelente'; color = '#10b981'; }
                                    else if (pct >= 60) { status = '‚Üí Bueno'; color = '#3b82f6'; }
                                    else if (pct >= 40) { status = '‚ö† Mejorable'; color = '#eab308'; }

                                    return (
                                        <div key={dim} className="dimension-result-card">
                                            <h3>{questionsData[dim].icon} {questionsData[dim].title}</h3>
                                            <div className="dimension-score">{pct.toFixed(1)}%</div>
                                            <div style={{fontSize: '0.85rem', color: '#64748b', marginBottom: '8px'}}>
                                                {results.dimensions[dim].score} de {results.dimensions[dim].maxScore} puntos
                                            </div>
                                            <div style={{
                                                display: 'inline-block',
                                                padding: '6px 14px',
                                                borderRadius: '12px',
                                                fontSize: '0.8rem',
                                                fontWeight: '700',
                                                color: 'white',
                                                backgroundColor: color,
                                                marginBottom: '12px'
                                            }}>
                                                {status}
                                            </div>
                                            <div className="dimension-bar">
                                                <div className="dimension-bar-fill" style={{width: `${pct}%`}}></div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>

                            <div className="roadmap-section">
                                <h3>üó∫Ô∏è Su Roadmap de Transformaci√≥n Digital</h3>
                                <p style={{fontSize: '1.1rem', color: '#065f46', marginBottom: '24px', lineHeight: '1.7'}}>
                                    Basado en su nivel <strong>{results.level.name}</strong>, estos son los pr√≥ximos pasos 
                                    recomendados seg√∫n el <strong>Modelo Integral de Evoluci√≥n Digital Empresarial</strong>:
                                </p>

                                <div className="roadmap-steps">
                                    {roadmap.map((step, idx) => (
                                        <div key={idx} className="roadmap-step">
                                            <div className="roadmap-step-number">{step.step}</div>
                                            <h4>{step.title}</h4>
                                            <p>{step.desc}</p>
                                            <ul>
                                                {step.actions.map((action, i) => (
                                                    <li key={i}>{action}</li>
                                                ))}
                                            </ul>
                                        </div>
                                    ))}
                                </div>

                                <div style={{
                                    marginTop: '30px',
                                    padding: '24px',
                                    background: 'white',
                                    borderRadius: '12px',
                                    border: '2px solid #10b981'
                                }}>
                                    <h4 style={{color: '#065f46', marginBottom: '12px', fontSize: '1.2rem'}}>
                                        üí° Pr√≥ximos Pasos Inmediatos
                                    </h4>
                                    <ol style={{paddingLeft: '20px', color: '#334155'}}>
                                        <li style={{marginBottom: '8px'}}>Compartir estos resultados con equipo directivo</li>
                                        <li style={{marginBottom: '8px'}}>Agendar sesi√≥n de trabajo para priorizar acciones (2-3 horas)</li>
                                        <li style={{marginBottom: '8px'}}>Asignar responsable de cada paso del roadmap</li>
                                        <li style={{marginBottom: '8px'}}>Establecer fechas y presupuesto para primeras 3 acciones</li>
                                        <li style={{marginBottom: '8px'}}>Re-evaluar progreso en 6 meses</li>
                                    </ol>
                                </div>
                            </div>

                            <div className="action-buttons">
                                <button className="btn btn-success" onClick={exportPDF}>
                                    üìÑ Exportar Resultados
                                </button>
                                <button className="btn btn-primary" onClick={() => setScreen('evaluation')}>
                                    ‚úèÔ∏è Revisar Respuestas
                                </button>
                                <button className="btn btn-secondary" onClick={reset}>
                                    üîÑ Nueva Evaluaci√≥n
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // EVALUATION SCREEN
            const dimData = questionsData[currentDim];
            const dimKeys = Object.keys(questionsData);
            const dimIndex = dimKeys.indexOf(currentDim);
            const isLast = dimIndex === dimKeys.length - 1;

            return (
                <div className="app-container">
                    <div className="header">
                        <h1>{dimData.icon} {dimData.title}</h1>
                        <p className="subtitle">{dimData.questions.length} preguntas | Dimensi√≥n {dimIndex + 1} de {dimKeys.length}</p>
                    </div>

                    <div className="progress-section">
                        <div className="progress-bar-container">
                            <div className="progress-bar-fill" style={{width: `${getProgress()}%`}}></div>
                        </div>
                        <div className="progress-text">
                            {getProgress().toFixed(0)}% Completado
                        </div>
                    </div>

                    <div className="content">
                        <div className="dimension-header">
                            <h2>{dimData.icon} {dimData.title}</h2>
                            <p>{dimData.description}</p>
                        </div>

                        <div className="scale-reference">
                            <h4>üìè Escala de Evaluaci√≥n</h4>
                            <div className="scale-items">
                                {ratingScale.map(scale => (
                                    <div key={scale.value} className="scale-item">
                                        <div className="scale-item-number">{scale.value}</div>
                                        <div><strong>{scale.desc}</strong></div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {dimData.questions.map((q, idx) => {
                            const isAnswered = answers[currentDim]?.[idx] !== undefined;
                            
                            return (
                                <div key={idx} className={`question-card ${isAnswered ? 'answered' : ''}`}>
                                    <div className="question-header">
                                        <div className="question-number">{idx + 1}</div>
                                        <div className="question-text">{q}</div>
                                    </div>

                                    <div className="rating-options">
                                        {ratingScale.map(rating => (
                                            <div key={rating.value} className="rating-option">
                                                <input
                                                    type="radio"
                                                    id={`${currentDim}-${idx}-${rating.value}`}
                                                    name={`${currentDim}-${idx}`}
                                                    value={rating.value}
                                                    checked={answers[currentDim]?.[idx] === rating.value}
                                                    onChange={() => handleAnswer(currentDim, idx, rating.value)}
                                                />
                                                <label 
                                                    className="rating-label"
                                                    htmlFor={`${currentDim}-${idx}-${rating.value}`}
                                                >
                                                    <span className="rating-value">{rating.label}</span>
                                                    <span className="rating-desc">{rating.desc}</span>
                                                </label>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            );
                        })}

                        <div className="navigation">
                            <button
                                className="btn btn-secondary"
                                onClick={() => {
                                    if (dimIndex > 0) {
                                        setCurrentDim(dimKeys[dimIndex - 1]);
                                        window.scrollTo(0, 0);
                                    }
                                }}
                                disabled={dimIndex === 0}
                            >
                                ‚óÄÔ∏è Anterior
                            </button>

                            {!isLast ? (
                                <button
                                    className="btn btn-primary"
                                    onClick={() => {
                                        setCurrentDim(dimKeys[dimIndex + 1]);
                                        window.scrollTo(0, 0);
                                    }}
                                >
                                    Siguiente ‚ñ∂Ô∏è
                                </button>
                            ) : (
                                <button
                                    className="btn btn-success"
                                    onClick={() => {
                                        const prog = getProgress();
                                        if (prog < 70) {
                                            if (!confirm(`Has completado ${prog.toFixed(0)}% de la evaluaci√≥n. Para resultados √≥ptimos, recomendamos completar al menos 80%.\n\n¬øVer resultados parciales?`)) {
                                                return;
                                            }
                                        }
                                        setScreen('results');
                                        window.scrollTo(0, 0);
                                    }}
                                >
                                    ‚úÖ Ver Resultados
                                </button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>